# Universal Knowledge Platform Helm Chart Values

# Global configuration
global:
  environment: production
  imageRegistry: ""
  imagePullSecrets: []
  storageClass: ""

# Image configuration
image:
  repository: universal-knowledge-hub
  tag: latest
  pullPolicy: IfNotPresent

# API Service configuration
api:
  replicaCount: 3
  
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi
  
  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80
  
  service:
    type: ClusterIP
    port: 80
    targetPort: 8002
  
  ingress:
    enabled: true
    className: nginx
    annotations:
      kubernetes.io/ingress.class: nginx
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
      nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
      cert-manager.io/cluster-issuer: letsencrypt-prod
    hosts:
      - host: api.universal-knowledge-hub.com
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: universal-knowledge-hub-tls
        hosts:
          - api.universal-knowledge-hub.com
  
  livenessProbe:
    httpGet:
      path: /health
      port: 8002
    initialDelaySeconds: 30
    periodSeconds: 10
  
  readinessProbe:
    httpGet:
      path: /health
      port: 8002
    initialDelaySeconds: 5
    periodSeconds: 5

# Database configuration
database:
  postgresql:
    enabled: false  # Use external RDS
    host: universal-knowledge-hub-rds
    port: 5432
    database: ukp_db
    username: ukp_admin
    password: ""
  
  redis:
    enabled: false  # Use external ElastiCache
    host: universal-knowledge-hub-redis
    port: 6379

# External services configuration
externalServices:
  openai:
    apiKey: ""
  anthropic:
    apiKey: ""
  pinecone:
    apiKey: ""
    indexName: universal-knowledge-hub
  elasticsearch:
    url: ""
    apiKey: ""

# Monitoring configuration
monitoring:
  enabled: true
  prometheus:
    enabled: true
    serviceMonitor:
      enabled: true
      interval: 30s
  grafana:
    enabled: true
    dashboard:
      enabled: true

# Security configuration
security:
  secrets:
    enabled: true
    name: api-secrets
  serviceAccount:
    create: true
    name: universal-knowledge-hub-api
    annotations: {}

# Persistence configuration
persistence:
  enabled: true
  storageClass: ""
  accessMode: ReadWriteOnce
  size: 10Gi

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity
affinity: {}

# Pod security context
podSecurityContext:
  fsGroup: 1000
  runAsNonRoot: true
  runAsUser: 1000

# Container security context
containerSecurityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000
  capabilities:
    drop:
      - ALL 